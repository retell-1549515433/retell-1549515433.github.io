
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>算法竞赛模板整理 - retell&#39;s blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="前言写这篇blog的原因是之前打oi的时候没有怎么整理过板子，而且现在很多板子都忘了……所以现在还是重新把板子什么的都在这里打一遍好了。
图论部分spfa最短路数论部分数据结构部分堆 (洛谷P337,"> 
    <meta name="author" content="retell"> 
    <link rel="alternative" href="atom.xml" title="retell&#39;s blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/x.png"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
<link rel="stylesheet" href="/css/diaspora.css">

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">retell&#39;s blog</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;" data-url="http://yoursite.com"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">算法竞赛模板整理</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">算法竞赛模板整理</h1>
        <div class="stuff">
            <span>十二月 12, 2019</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/oi-acm/" rel="tag">oi/acm</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>


        </div>
        <div class="content markdown">
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>写这篇blog的原因是之前打oi的时候没有怎么整理过板子，而且现在很多板子都忘了……所以现在还是重新把板子什么的都在这里打一遍好了。<br><a id="more"></a></p>
<h2 id="图论部分"><a href="#图论部分" class="headerlink" title="图论部分"></a>图论部分</h2><h4 id="spfa最短路"><a href="#spfa最短路" class="headerlink" title="spfa最短路"></a>spfa最短路</h4><h2 id="数论部分"><a href="#数论部分" class="headerlink" title="数论部分"></a>数论部分</h2><h2 id="数据结构部分"><a href="#数据结构部分" class="headerlink" title="数据结构部分"></a>数据结构部分</h2><h4 id="堆-洛谷P3378"><a href="#堆-洛谷P3378" class="headerlink" title="堆 (洛谷P3378)"></a>堆 (洛谷P3378)</h4><p>stl版本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">priority_queue&lt;int&gt; p;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	int n,jud,x;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		scanf(&quot;%d&quot;,&amp;jud);</span><br><span class="line">		if(jud&#x3D;&#x3D;1)</span><br><span class="line">		&#123;</span><br><span class="line">			scanf(&quot;%d&quot;,&amp;x);</span><br><span class="line">			p.push(-x);</span><br><span class="line">		&#125;</span><br><span class="line">		else if(jud&#x3D;&#x3D;2) printf(&quot;%d\n&quot;,-p.top());</span><br><span class="line">		else p.pop();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>我也是写这篇博客的时候翻了一下才发现，我竟然从来没有手写过堆orz……顺手写了一个也放上来吧（虽然基本也用不到）<br>手写版本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int heap[2000000];</span><br><span class="line">int cnt&#x3D;0;</span><br><span class="line">void insert(int x)</span><br><span class="line">&#123;</span><br><span class="line">	cnt++;</span><br><span class="line">	int now&#x3D;cnt;</span><br><span class="line">	heap[now]&#x3D;x;</span><br><span class="line">	while(now) </span><br><span class="line">	&#123;</span><br><span class="line">		if(heap[now&gt;&gt;1]&gt;heap[now]) swap(heap[now&gt;&gt;1],heap[now]);</span><br><span class="line">		else break;</span><br><span class="line">		now&gt;&gt;&#x3D;1;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">void del()</span><br><span class="line">&#123;</span><br><span class="line">	swap(heap[1],heap[cnt]);</span><br><span class="line">	cnt--;</span><br><span class="line">	int now&#x3D;1;</span><br><span class="line">	while((now&lt;&lt;1)&lt;&#x3D;cnt)</span><br><span class="line">	&#123;</span><br><span class="line">		int son&#x3D;now&lt;&lt;1;</span><br><span class="line">		if(son+1&lt;&#x3D;cnt&amp;&amp;heap[son+1]&lt;heap[son]) son++;</span><br><span class="line">		if(heap[son]&lt;heap[now]) swap(heap[son],heap[now]);</span><br><span class="line">		else break;</span><br><span class="line">		now&#x3D;son;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	int n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		int jud;</span><br><span class="line">		scanf(&quot;%d&quot;,&amp;jud);</span><br><span class="line">		if(jud&#x3D;&#x3D;1)</span><br><span class="line">		&#123;</span><br><span class="line">			int x;</span><br><span class="line">			scanf(&quot;%d&quot;,&amp;x);</span><br><span class="line">			insert(x);</span><br><span class="line">		&#125;</span><br><span class="line">		else if(jud&#x3D;&#x3D;2) printf(&quot;%d\n&quot;,heap[1]);</span><br><span class="line">		else del();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="可并堆-左偏树（洛谷P3377）"><a href="#可并堆-左偏树（洛谷P3377）" class="headerlink" title="可并堆/左偏树（洛谷P3377）"></a>可并堆/左偏树（洛谷P3377）</h4><p>在堆的基础上支持了堆的合并操作，而且其实并不难写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int N&#x3D;1e5+10;</span><br><span class="line">int c[N][2],dis[N],fa[N],val[N];</span><br><span class="line">int read()</span><br><span class="line">&#123;</span><br><span class="line">	int x&#x3D;0,f&#x3D;1;char ch;</span><br><span class="line">	do&#123;ch&#x3D;getchar();if(ch&#x3D;&#x3D;&#39;-&#39;)f&#x3D;-1;&#125;while(ch&gt;&#39;9&#39;||ch&lt;&#39;0&#39;);</span><br><span class="line">	do&#123;x&#x3D;(x&lt;&lt;1)+(x&lt;&lt;3)+ch-&#39;0&#39;;ch&#x3D;getchar();&#125;while(ch&gt;&#x3D;&#39;0&#39;&amp;&amp;ch&lt;&#x3D;&#39;9&#39;);</span><br><span class="line">	return f*x;</span><br><span class="line">&#125;</span><br><span class="line">int merge(int x,int y)</span><br><span class="line">&#123;</span><br><span class="line">	&#x2F;&#x2F;cout&lt;&lt;x&lt;&lt;y;</span><br><span class="line">	if(x&#x3D;&#x3D;0||y&#x3D;&#x3D;0) return x+y;</span><br><span class="line">	if(val[x]&gt;val[y]) swap(x,y);</span><br><span class="line">	c[x][1]&#x3D;merge(c[x][1],y);</span><br><span class="line">	fa[c[x][1]]&#x3D;x;</span><br><span class="line">	if(dis[c[x][0]]&lt;dis[c[x][1]])swap(c[x][0],c[x][1]);</span><br><span class="line">	dis[x]&#x3D;dis[c[x][1]]+1;</span><br><span class="line">	return x;</span><br><span class="line">&#125;</span><br><span class="line">int find(int x)</span><br><span class="line">&#123;</span><br><span class="line">	while(fa[x]) x&#x3D;fa[x];</span><br><span class="line">	return x;</span><br><span class="line">&#125;</span><br><span class="line">void pop(int x)</span><br><span class="line">&#123;</span><br><span class="line">	val[x]&#x3D;0;</span><br><span class="line">	fa[c[x][0]]&#x3D;fa[c[x][1]]&#x3D;0;</span><br><span class="line">	merge(c[x][0],c[x][1]);</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	int n&#x3D;read(),m&#x3D;read();</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;n;i++) val[i]&#x3D;read();</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;m;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		int jud&#x3D;read();</span><br><span class="line">		if(jud&#x3D;&#x3D;1)</span><br><span class="line">		&#123;</span><br><span class="line">			int x&#x3D;read(),y&#x3D;read();</span><br><span class="line">			if(!val[x]||!val[y]) continue;</span><br><span class="line">			if(x&#x3D;&#x3D;y) continue;</span><br><span class="line">			int fax&#x3D;find(x),fay&#x3D;find(y);</span><br><span class="line">			merge(fax,fay);</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			int x&#x3D;read();</span><br><span class="line">			if(!val[x]) printf(&quot;-1\n&quot;);</span><br><span class="line">			else</span><br><span class="line">			&#123;</span><br><span class="line">				int y&#x3D;find(x);</span><br><span class="line">				printf(&quot;%d\n&quot;,val[y]);</span><br><span class="line">				pop(y);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="线段树（洛谷P3377）"><a href="#线段树（洛谷P3377）" class="headerlink" title="线段树（洛谷P3377）"></a>线段树（洛谷P3377）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">#define LL long long</span><br><span class="line">using namespace std;</span><br><span class="line">int val[200000];</span><br><span class="line">struct point</span><br><span class="line">&#123;</span><br><span class="line">	int l,r;</span><br><span class="line">	long long tag,val;</span><br><span class="line">&#125;p[2000000];</span><br><span class="line">void build(int x,int l,int r)</span><br><span class="line">&#123;</span><br><span class="line">	int mid&#x3D;(l+r)&gt;&gt;1;</span><br><span class="line">	p[x].l&#x3D;l,p[x].r&#x3D;r;</span><br><span class="line">	if(l&#x3D;&#x3D;r) p[x].val&#x3D;val[l];</span><br><span class="line">	else build(x&lt;&lt;1,l,mid),build((x&lt;&lt;1)|1,mid+1,r),p[x].val&#x3D;p[x&lt;&lt;1].val+p[(x&lt;&lt;1)|1].val;</span><br><span class="line">	return;</span><br><span class="line">&#125; </span><br><span class="line">void pushdown(int x);</span><br><span class="line">void add(int val,int l,int r,int x)</span><br><span class="line">&#123;</span><br><span class="line">	pushdown(x);</span><br><span class="line">	int mid&#x3D;(p[x].l+p[x].r)&gt;&gt;1;</span><br><span class="line">	if(l&#x3D;&#x3D;p[x].l&amp;&amp;r&#x3D;&#x3D;p[x].r)</span><br><span class="line">	&#123;</span><br><span class="line">		p[x].tag+&#x3D;val;</span><br><span class="line">		return;</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;	if(r&lt;&#x3D;mid) add(val,l,r,x&lt;&lt;1);</span><br><span class="line">		else if(l&gt;mid) add(val,l,r,(x&lt;&lt;1)|1);</span><br><span class="line">		else add(val,l,mid,x&lt;&lt;1),add(val,mid+1,r,(x&lt;&lt;1)|1);</span><br><span class="line">		pushdown(x&lt;&lt;1),pushdown((x&lt;&lt;1)|1),p[x].val&#x3D;p[x&lt;&lt;1].val+p[(x&lt;&lt;1)|1].val;</span><br><span class="line">	&#125;</span><br><span class="line">	return;</span><br><span class="line">&#125;</span><br><span class="line">void pushdown(int x)</span><br><span class="line">&#123;</span><br><span class="line">	if(!p[x].tag) return;</span><br><span class="line">	p[x].val+&#x3D;(p[x].tag*(p[x].r-p[x].l+1));</span><br><span class="line">	p[x&lt;&lt;1].tag+&#x3D;p[x].tag,p[(x&lt;&lt;1)|1].tag+&#x3D;p[x].tag;</span><br><span class="line">	p[x].tag&#x3D;0;</span><br><span class="line">	return;</span><br><span class="line">&#125;</span><br><span class="line">LL get_val(int l,int r,int x)</span><br><span class="line">&#123;</span><br><span class="line">	pushdown(x);</span><br><span class="line">	int mid&#x3D;(p[x].l+p[x].r)&gt;&gt;1;</span><br><span class="line">	if(l&#x3D;&#x3D;p[x].l&amp;&amp;r&#x3D;&#x3D;p[x].r) return p[x].val;</span><br><span class="line">	if(r&lt;&#x3D;mid) return get_val(l,r,x&lt;&lt;1);</span><br><span class="line">	else if(l&gt;mid) return get_val(l,r,(x&lt;&lt;1)|1);</span><br><span class="line">	else return get_val(l,mid,x&lt;&lt;1)+get_val(mid+1,r,(x&lt;&lt;1)|1);</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	int n,m;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;n;i++) scanf(&quot;%d&quot;,&amp;val[i]);</span><br><span class="line">	build(1,1,n);</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;m;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		int jud;</span><br><span class="line">		scanf(&quot;%d&quot;,&amp;jud);</span><br><span class="line">		if(jud&#x3D;&#x3D;1)</span><br><span class="line">		&#123;</span><br><span class="line">			int aa,bb,cc;</span><br><span class="line">			scanf(&quot;%d%d%d&quot;,&amp;aa,&amp;bb,&amp;cc);</span><br><span class="line">			add(cc,aa,bb,1);</span><br><span class="line">		&#125; </span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			int aa,bb;</span><br><span class="line">			scanf(&quot;%d%d&quot;,&amp;aa,&amp;bb);</span><br><span class="line">			printf(&quot;%lld\n&quot;,get_val(aa,bb,1));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="splay-洛谷P3391"><a href="#splay-洛谷P3391" class="headerlink" title="splay(洛谷P3391)"></a>splay(洛谷P3391)</h4><p>说起来我好像只会这一种平衡树……有时间的话还是把treap和红黑树什么的补一下好了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int N&#x3D;100020;</span><br><span class="line">int root,tol;</span><br><span class="line">int n,m,aa,bb;</span><br><span class="line">struct Splay</span><br><span class="line">&#123;</span><br><span class="line">    int c[N][2],val[N],fa[N],rev[N],siz[N];</span><br><span class="line">    void pushup(int x)</span><br><span class="line">    &#123;</span><br><span class="line">        siz[x]&#x3D;siz[c[x][0]]+siz[c[x][1]]+1;</span><br><span class="line">    &#125;</span><br><span class="line">    void pushdown(int x)</span><br><span class="line">    &#123;</span><br><span class="line">        int l&#x3D;c[x][0],r&#x3D;c[x][1];</span><br><span class="line">        if(rev[x])</span><br><span class="line">        &#123;</span><br><span class="line">            rev[x]^&#x3D;1,rev[l]^&#x3D;1,rev[r]^&#x3D;1;</span><br><span class="line">            swap(c[x][0],c[x][1]);</span><br><span class="line">        &#125;	</span><br><span class="line">    &#125;</span><br><span class="line">    void rotate(int x)</span><br><span class="line">    &#123;</span><br><span class="line">        int y&#x3D;fa[x],z&#x3D;fa[y],l,r;</span><br><span class="line">        if(x&#x3D;&#x3D;c[y][0])l&#x3D;0;else l&#x3D;1;r&#x3D;l^1;</span><br><span class="line">        if(y&#x3D;&#x3D;c[z][0]) c[z][0]&#x3D;x;else c[z][1]&#x3D;x;</span><br><span class="line">        fa[x]&#x3D;z,fa[y]&#x3D;x,fa[c[x][r]]&#x3D;y;</span><br><span class="line">        c[y][l]&#x3D;c[x][r],c[x][r]&#x3D;y;</span><br><span class="line">        pushup(y),pushup(x);</span><br><span class="line">    &#125;</span><br><span class="line">    void splay(int x,int to)</span><br><span class="line">    &#123;</span><br><span class="line">        while(fa[x]!&#x3D;to)</span><br><span class="line">        &#123;</span><br><span class="line">            int y&#x3D;fa[x],z&#x3D;fa[y];</span><br><span class="line">            if(z!&#x3D;to)&#123;if((c[z][0]&#x3D;&#x3D;y)^(c[y][0]&#x3D;&#x3D;x))rotate(x);else rotate(y);&#125;</span><br><span class="line">            rotate(x);</span><br><span class="line">        &#125;</span><br><span class="line">        if(to&#x3D;&#x3D;0) root&#x3D;x;</span><br><span class="line">    &#125;</span><br><span class="line">    void insert(int x)</span><br><span class="line">    &#123;</span><br><span class="line">        int now&#x3D;root,f&#x3D;0;</span><br><span class="line">        while(now) f&#x3D;now,now&#x3D;c[now][x&gt;val[now]];</span><br><span class="line">        now&#x3D;++tol;</span><br><span class="line">        if(f) c[f][x&gt;val[f]]&#x3D;tol,fa[tol]&#x3D;f;</span><br><span class="line">        siz[tol]&#x3D;1;</span><br><span class="line">        val[tol]&#x3D;x;</span><br><span class="line">        splay(tol,0);</span><br><span class="line">    &#125;</span><br><span class="line">    void write(int x)</span><br><span class="line">    &#123;</span><br><span class="line">        pushdown(x);</span><br><span class="line">        if(c[x][0]) write(c[x][0]);</span><br><span class="line">        if(val[x]&gt;1&amp;&amp;val[x]&lt;n+2)cout&lt;&lt;val[x]-1&lt;&lt;&quot; &quot;;</span><br><span class="line">        if(c[x][1]) write(c[x][1]);</span><br><span class="line">    &#125;</span><br><span class="line">    int find(int x)</span><br><span class="line">    &#123;</span><br><span class="line">        int now&#x3D;root;</span><br><span class="line">        while(1)</span><br><span class="line">        &#123;</span><br><span class="line">            pushdown(now);</span><br><span class="line">            if(x&#x3D;&#x3D;siz[c[now][0]]+1) return now;</span><br><span class="line">            else if(x&lt;&#x3D;siz[c[now][0]]) now&#x3D;c[now][0];</span><br><span class="line">            else x-&#x3D;siz[c[now][0]]+1,now&#x3D;c[now][1];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    void work(int l,int r)</span><br><span class="line">    &#123;</span><br><span class="line">        int x&#x3D;find(l),y&#x3D;find(r+2);</span><br><span class="line">        splay(x,0),splay(y,x);</span><br><span class="line">        rev[c[c[root][1]][0]]^&#x3D;1;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;spa;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    scanf(&quot;%d%d&quot;,&amp;n,&amp;m);</span><br><span class="line">    for(int i&#x3D;1;i&lt;&#x3D;n+2;i++) spa.insert(i);</span><br><span class="line">    for(int i&#x3D;1;i&lt;&#x3D;m;i++)</span><br><span class="line">    scanf(&quot;%d%d&quot;,&amp;aa,&amp;bb),spa.work(aa,bb);</span><br><span class="line">    spa.write(root);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="link-cut-tree-lct-动态树（洛谷P3690）"><a href="#link-cut-tree-lct-动态树（洛谷P3690）" class="headerlink" title="link cut tree/lct/动态树（洛谷P3690）"></a>link cut tree/lct/动态树（洛谷P3690）</h4><p>说起来当时还是因为要用lct才学的splay来着？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int N&#x3D;1e6;</span><br><span class="line">int val[N];</span><br><span class="line">struct link_cut_tree</span><br><span class="line">&#123;</span><br><span class="line">	int c[N][2],fa[N],rev[N],q[N],xr[N];</span><br><span class="line">	bool isroot(int x)&#123;return (c[fa[x]][0]!&#x3D;x)&amp;&amp;(c[fa[x]][1]!&#x3D;x);&#125;</span><br><span class="line">	void pushup(int x)</span><br><span class="line">	&#123;</span><br><span class="line">		xr[x]&#x3D;val[x];</span><br><span class="line">		xr[x]&#x3D;xr[x]^xr[c[x][0]]^xr[c[x][1]];</span><br><span class="line">	&#125;</span><br><span class="line">	void pushdown(int x)</span><br><span class="line">	&#123;</span><br><span class="line">		int l&#x3D;c[x][0],r&#x3D;c[x][1];</span><br><span class="line">		if(rev[x])</span><br><span class="line">		&#123;</span><br><span class="line">			rev[x]^&#x3D;1,rev[l]^&#x3D;1,rev[r]^&#x3D;1;</span><br><span class="line">			swap(c[x][0],c[x][1]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	void rotate(int x)</span><br><span class="line">	&#123;</span><br><span class="line">		int y&#x3D;fa[x],z&#x3D;fa[y],l,r;</span><br><span class="line">		if(c[y][0]&#x3D;&#x3D;x)l&#x3D;0;else l&#x3D;1;r&#x3D;l^1;</span><br><span class="line">		if(!isroot(y))&#123;if(y&#x3D;&#x3D;c[z][0])c[z][0]&#x3D;x;else c[z][1]&#x3D;x;&#125;</span><br><span class="line">		fa[x]&#x3D;z,fa[y]&#x3D;x,fa[c[x][r]]&#x3D;y;</span><br><span class="line">		c[y][l]&#x3D;c[x][r],c[x][r]&#x3D;y;</span><br><span class="line">		pushup(y),pushup(x);</span><br><span class="line">	&#125;</span><br><span class="line">	void splay(int x)</span><br><span class="line">	&#123;</span><br><span class="line">		int top&#x3D;1;q[top]&#x3D;x;</span><br><span class="line">		for(int i&#x3D;x;!isroot(i);i&#x3D;fa[i]) q[++top]&#x3D;fa[i];</span><br><span class="line">		for(int i&#x3D;top;i;i--) pushdown(q[i]);</span><br><span class="line">		while(!isroot(x))</span><br><span class="line">		&#123;</span><br><span class="line">			int y&#x3D;fa[x],z&#x3D;fa[y];</span><br><span class="line">			if(!isroot(y))&#123;if((c[z][0]&#x3D;&#x3D;y)^(c[y][0]&#x3D;&#x3D;x))rotate(x);else rotate(y);&#125;</span><br><span class="line">			rotate(x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	void access(int x)&#123;for(int t&#x3D;0;x;t&#x3D;x,x&#x3D;fa[x])splay(x),c[x][1]&#x3D;t,pushup(x);&#125;</span><br><span class="line">	void makeroot(int x)&#123;access(x),splay(x),rev[x]^&#x3D;1;&#125;</span><br><span class="line">	int find(int x)&#123;access(x),splay(x);while(c[x][0])x&#x3D;c[x][0];return x;&#125;</span><br><span class="line">	void spilt(int x,int y)&#123;makeroot(x),access(y),splay(y);&#125;</span><br><span class="line">	void cut(int x,int y)&#123;spilt(x,y);if(c[y][0]&#x3D;&#x3D;x&amp;&amp;c[x][1]&#x3D;&#x3D;0)fa[x]&#x3D;c[y][0]&#x3D;0;&#125;</span><br><span class="line">	void link(int x,int y)&#123;makeroot(x);fa[x]&#x3D;y;&#125;</span><br><span class="line">	int query(int x,int y)&#123;spilt(x,y);return xr[y];&#125;</span><br><span class="line">&#125;lct;</span><br><span class="line">int read()</span><br><span class="line">&#123;</span><br><span class="line">	int x&#x3D;0,f&#x3D;1;char ch;</span><br><span class="line">	do&#123;ch&#x3D;getchar();if(ch&#x3D;&#x3D;&#39;-&#39;)f&#x3D;-1;&#125;while(ch&gt;&#39;9&#39;||ch&lt;&#39;0&#39;);</span><br><span class="line">	do&#123;x&#x3D;(x&lt;&lt;1)+(x&lt;&lt;3)+ch-&#39;0&#39;;ch&#x3D;getchar();&#125;while(ch&gt;&#x3D;&#39;0&#39;&amp;&amp;ch&lt;&#x3D;&#39;9&#39;);</span><br><span class="line">	return f*x;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	int n&#x3D;read(),m&#x3D;read();</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;n;i++) val[i]&#x3D;read();</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;m;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		int jud&#x3D;read(),xx&#x3D;read(),yy&#x3D;read();</span><br><span class="line">		if(jud&#x3D;&#x3D;0) printf(&quot;%d\n&quot;,lct.query(xx,yy));</span><br><span class="line">		else if(jud&#x3D;&#x3D;1) lct.link(xx,yy);</span><br><span class="line">		else if(jud&#x3D;&#x3D;2) lct.cut(xx,yy);</span><br><span class="line">		else lct.makeroot(xx),val[xx]&#x3D;yy,lct.pushup(xx);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="数学部分"><a href="#数学部分" class="headerlink" title="数学部分"></a>数学部分</h2><h4 id="fft-快速离散傅里叶变换（洛谷P3803）"><a href="#fft-快速离散傅里叶变换（洛谷P3803）" class="headerlink" title="fft/快速离散傅里叶变换（洛谷P3803）"></a>fft/快速离散傅里叶变换（洛谷P3803）</h4><p>这个如果放在数学部分，那ntt是不是要放在数论部分呢？（迷惑发言）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define pi acos(-1)</span><br><span class="line">int n,m,l;</span><br><span class="line">int rev[5000000];</span><br><span class="line">int read()</span><br><span class="line">&#123;</span><br><span class="line">	int x&#x3D;0,f&#x3D;1;char ch;</span><br><span class="line">	do&#123;ch&#x3D;getchar();if(ch&#x3D;&#x3D;&#39;-&#39;)f&#x3D;-1;&#125;while(ch&gt;&#39;9&#39;||ch&lt;&#39;0&#39;);</span><br><span class="line">	do&#123;x&#x3D;(x&lt;&lt;1)+(x&lt;&lt;3)+ch-&#39;0&#39;;ch&#x3D;getchar();&#125;while(ch&gt;&#x3D;&#39;0&#39;&amp;&amp;ch&lt;&#x3D;&#39;9&#39;);</span><br><span class="line">	return x*f;</span><br><span class="line">&#125;</span><br><span class="line">typedef complex&lt;double&gt; E;</span><br><span class="line">E a[5000000],b[5000000];</span><br><span class="line">void fft(E *a,int f)</span><br><span class="line">&#123;</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;n;i++) if(i&lt;rev[i]) swap(a[i],a[rev[i]]);</span><br><span class="line">	for(int i&#x3D;1;i&lt;n;i&lt;&lt;&#x3D;1)</span><br><span class="line">	&#123;</span><br><span class="line">		E wn(cos(pi&#x2F;i),f*sin(pi&#x2F;i));</span><br><span class="line">		for(int p&#x3D;i&lt;&lt;1,j&#x3D;0;j&lt;n;j+&#x3D;p)</span><br><span class="line">		&#123;</span><br><span class="line">			E w(1,0);</span><br><span class="line">			for(int k&#x3D;0;k&lt;i;k++,w*&#x3D;wn)</span><br><span class="line">			&#123;</span><br><span class="line">				E x&#x3D;a[j+k],y&#x3D;w*a[j+k+i];</span><br><span class="line">				a[j+k]&#x3D;x+y,a[j+k+i]&#x3D;x-y;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	n&#x3D;read(),m&#x3D;read();</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;n;i++)a[i]&#x3D;read();</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;m;i++)b[i]&#x3D;read();</span><br><span class="line">	m+&#x3D;n;</span><br><span class="line">	for(n&#x3D;1;n&lt;&#x3D;m;n&lt;&lt;&#x3D;1) l++;</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;n;i++) rev[i]&#x3D;(rev[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)&lt;&lt;(l-1));</span><br><span class="line">	fft(a,1),fft(b,1);</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;n;i++) a[i]*&#x3D;b[i];</span><br><span class="line">	fft(a,-1);</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;m;i++)</span><br><span class="line">	printf(&quot;%d &quot;,(int)(a[i].real()&#x2F;n+0.5));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="ntt-快速数论变换（洛谷P3803）"><a href="#ntt-快速数论变换（洛谷P3803）" class="headerlink" title="ntt/快速数论变换（洛谷P3803）"></a>ntt/快速数论变换（洛谷P3803）</h4><p>emmm果然还是和fft放一起好了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int mod&#x3D;998244353,g&#x3D;3,gi&#x3D;332748118;</span><br><span class="line">const int N&#x3D;5e6;</span><br><span class="line">int a[N],b[N],rev[N],n,m,l,inv;</span><br><span class="line">int mul(int a,int b)&#123;return (long long)a*b%mod;&#125;</span><br><span class="line">int pow(int a,int b)</span><br><span class="line">&#123;</span><br><span class="line">	int ans;</span><br><span class="line">	for(ans&#x3D;1;b;b&gt;&gt;&#x3D;1,a&#x3D;mul(a,a))</span><br><span class="line">	if(b&amp;1)ans&#x3D;mul(ans,a);</span><br><span class="line">	return ans;</span><br><span class="line">&#125;</span><br><span class="line">void ntt(int *a,int f)</span><br><span class="line">&#123;</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;n;i++)if(i&lt;rev[i])swap(a[i],a[rev[i]]);</span><br><span class="line">	for(int i&#x3D;1;i&lt;n;i&lt;&lt;&#x3D;1)</span><br><span class="line">	&#123;</span><br><span class="line">		int wn&#x3D;pow((f&#x3D;&#x3D;1)?g:gi,(mod-1)&#x2F;(i&lt;&lt;1));</span><br><span class="line">		for(int p&#x3D;i&lt;&lt;1,j&#x3D;0;j&lt;n;j+&#x3D;p)</span><br><span class="line">		&#123;</span><br><span class="line">			int w&#x3D;1;</span><br><span class="line">			for(int k&#x3D;0;k&lt;i;k++,w&#x3D;mul(w,wn))</span><br><span class="line">			&#123;</span><br><span class="line">				int x&#x3D;a[j+k],y&#x3D;mul(w,a[i+j+k]);</span><br><span class="line">				a[j+k]&#x3D;(x+y)%mod,a[i+j+k]&#x3D;(x-y+mod)%mod;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	if(f&#x3D;&#x3D;-1)for(int i&#x3D;0;i&lt;&#x3D;n;i++) a[i]&#x3D;mul(a[i],inv);</span><br><span class="line">&#125;</span><br><span class="line">int read()</span><br><span class="line">&#123;</span><br><span class="line">	int x&#x3D;0,f&#x3D;1;char ch;</span><br><span class="line">	do&#123;ch&#x3D;getchar();if(ch&#x3D;&#x3D;&#39;-&#39;)f&#x3D;-1;&#125;while(ch&gt;&#39;9&#39;||ch&lt;&#39;0&#39;);</span><br><span class="line">	do&#123;x&#x3D;(x&lt;&lt;1)+(x&lt;&lt;3)+ch-&#39;0&#39;;ch&#x3D;getchar();&#125;while(ch&gt;&#x3D;&#39;0&#39;&amp;&amp;ch&lt;&#x3D;&#39;9&#39;);</span><br><span class="line">	return x*f;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	n&#x3D;read(),m&#x3D;read();</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;n;i++)a[i]&#x3D;read();</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;m;i++)b[i]&#x3D;read();</span><br><span class="line">	m+&#x3D;n;</span><br><span class="line">	for(n&#x3D;1;n&lt;&#x3D;m;n&lt;&lt;&#x3D;1)l++;</span><br><span class="line">	inv&#x3D;pow(n,mod-2);</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;n;i++)rev[i]&#x3D;(rev[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)&lt;&lt;(l-1));</span><br><span class="line">	ntt(a,1),ntt(b,1);</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;n;i++)a[i]&#x3D;mul(a[i],b[i]);</span><br><span class="line">	ntt(a,-1);</span><br><span class="line">	for(int i&#x3D;0;i&lt;&#x3D;m;i++)printf(&quot;%d &quot;,a[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="字符串部分"><a href="#字符串部分" class="headerlink" title="字符串部分"></a>字符串部分</h2><h4 id="kmp算法（洛谷P3375）"><a href="#kmp算法（洛谷P3375）" class="headerlink" title="kmp算法（洛谷P3375）"></a>kmp算法（洛谷P3375）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">char a[3000000],b[3000000];</span><br><span class="line">int nxt[3000000],lena,lenb;</span><br><span class="line">using namespace std;</span><br><span class="line">void Pre()</span><br><span class="line">&#123;</span><br><span class="line">	int k&#x3D;0;</span><br><span class="line">	for(int i&#x3D;2;i&lt;lenb;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		while(k&amp;&amp;b[i]!&#x3D;b[k+1]) k&#x3D;nxt[k];</span><br><span class="line">		if(b[k+1]&#x3D;&#x3D;b[i]) k++;</span><br><span class="line">		nxt[i]&#x3D;k;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">void kmp()</span><br><span class="line">&#123;</span><br><span class="line">	int k&#x3D;0;</span><br><span class="line">	for(int i&#x3D;1;i&lt;lena;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		while(k&amp;&amp;a[i]!&#x3D;b[k+1]) k&#x3D;nxt[k];</span><br><span class="line">		if(a[i]&#x3D;&#x3D;b[k+1]) k++;</span><br><span class="line">		if(k&#x3D;&#x3D;lenb-1)</span><br><span class="line">		&#123;</span><br><span class="line">			printf(&quot;%d\n&quot;,i-lenb+2);</span><br><span class="line">			k&#x3D;nxt[k];</span><br><span class="line">		 &#125; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	scanf(&quot;%s%s&quot;,a+1,b+1);</span><br><span class="line">	a[0]&#x3D;&#39; &#39;;</span><br><span class="line">	b[0]&#x3D;&#39; &#39;;</span><br><span class="line">	lena&#x3D;strlen(a),lenb&#x3D;strlen(b);</span><br><span class="line">	Pre();</span><br><span class="line">	kmp();</span><br><span class="line">	for(int i&#x3D;1;i&lt;lenb;i++)</span><br><span class="line">	printf(&quot;%d &quot;,nxt[i]);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="manacher算法（洛谷P3805）"><a href="#manacher算法（洛谷P3805）" class="headerlink" title="manacher算法（洛谷P3805）"></a>manacher算法（洛谷P3805）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">char a[15000000],aa[50000000];</span><br><span class="line">int n,hw[50000000];</span><br><span class="line">void manachar()</span><br><span class="line">&#123;</span><br><span class="line">	int maxright&#x3D;0,mid;</span><br><span class="line">	for(int i&#x3D;1;i&lt;n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		if(i&lt;maxright)</span><br><span class="line">		hw[i]&#x3D;min(hw[2*mid-i],hw[mid]+mid-i);</span><br><span class="line">		else</span><br><span class="line">		hw[i]&#x3D;1;</span><br><span class="line">		for(;aa[i+hw[i]]&#x3D;&#x3D;aa[i-hw[i]];++hw[i])</span><br><span class="line">		maxright&#x3D;hw[i]+i,mid&#x3D;i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	scanf(&quot;%s&quot;,a);</span><br><span class="line">	n&#x3D;strlen(a);</span><br><span class="line">	aa[0]&#x3D;aa[1]&#x3D;&#39;#&#39;;</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;n;i++)</span><br><span class="line">	aa[i*2]&#x3D;a[i-1],aa[i*2+1]&#x3D;&#39;#&#39;;</span><br><span class="line">	n&#x3D;n*2+2;</span><br><span class="line">	aa[n]&#x3D;&#39;0&#39;;</span><br><span class="line">	manachar();</span><br><span class="line">	int ans&#x3D;1;</span><br><span class="line">	for(int i&#x3D;1;i&lt;n;i++)</span><br><span class="line">	ans&#x3D;max(ans,hw[i]);</span><br><span class="line">	printf(&quot;%d&quot;,ans-1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="AC自动机（）"><a href="#AC自动机（）" class="headerlink" title="AC自动机（）"></a>AC自动机（）</h4>
            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title='0' data-url='http://link.hhtjim.com/163/5146554.mp3'></li>
                        
                    
                        
                            <li title='1' data-url='http://link.hhtjim.com/qq/001faIUs4M2zna.mp3'></li>
                        
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
        data-ae='false'
        data-ci='8f09c1f2797321b07604'
        data-cs='f2591299f02fe91e409939e9a7967052b3a2253a'
        data-r='retell-1549515433.github.io'
        data-o='retell-1549515433'
        data-a='retell-1549515433'
        data-d='false'
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>
